<form class="app-user-form" [formGroup]="form" 
    [sbFormControlFirstError]="form">
    <!-- <h2>User Information</h2>
    <p class="description">Manage user account details and settings.</p> -->
    
    <!-- Personal Information Section -->
    <div class="form-section">
        <h3>Personal Information</h3>
        <div class="form-row">
                <input  hidden
                    [id]="'id'" 
                    type="text" 
                    formControlName="id" 
                    placeholder="User ID" 
                    sbInputStyle />
            
            <div class="form-group">
                @if(showLabels()) {
                    <label [for]="'firstName'">First Name</label>
                }                
                <input 
                    [id]="'firstName'" 
                    [color]="color()"
                    type="text" 
                    formControlName="firstName" 
                    placeholder="First Name" 
                    sbInputStyle />
                    @if(form.controls.firstName.errors?.['firstError']; as err){
                        <div class="error">
                            {{err}}
                        </div>  
                    }
                <!-- <sb-first-error [control]="form.controls.firstName"/> -->
            </div>
        </div>
        
        <div class="form-row">
            <div class="form-group">
                @if(showLabels()) {
                    <label [for]="'lastName'">Last Name</label>
                }                
                <input 
                    [id]="'lastName'" 
                    [color]="color()"
                    type="text" 
                    formControlName="lastName" 
                    placeholder="Last Name" 
                    sbInputStyle />
                <sb-first-error [control]="form.controls.lastName"/>
            </div>
            
            <div class="form-group">
                @if(showLabels()) {
                    <label [for]="'phoneNumber'">Phone Number</label>
                }                
                <input 
                    [id]="'phoneNumber'" 
                    [color]="color()"
                    type="tel" 
                    formControlName="phoneNumber" 
                    placeholder="Phone Number" 
                    sbInputStyle />
                <sb-first-error [control]="form.controls.phoneNumber"/>
            </div>
        </div>
    </div>

    <!-- Account Information Section -->
    <div class="form-section">
        <h3>Account Information</h3>
        <div class="form-row">
            <div class="form-group">
                @if(showLabels()) {
                    <label [for]="'userName'">Username</label>
                }                
                <input 
                    [id]="'userName'" 
                    type="text" 
                    [color]="color()"
                    formControlName="userName" 
                    placeholder="Username" 
                    sbInputStyle />
                <sb-first-error [control]="form.controls.userName"/>
            </div>
            
            <div class="form-group">
                @if(showLabels()) {
                    <label [for]="'email'">Email</label>
                }               
                 <input 
                    [id]="'email'" 
                    type="email" 
                    [color]="color()"
                    formControlName="email" 
                    placeholder="Email Address" 
                    sbInputStyle />
                <sb-first-error [control]="form.controls.email"/>
            </div>
        </div>
        
        <div class="form-row">
            <div class="form-group">
                @if(showLabels()) {
                    <label [for]="'teamId'">Team ID</label>
                }                <input 
                    [id]="'teamId'" 
                    type="text" 
                    formControlName="teamId" 
                    placeholder="Team ID" 
                    sbInputStyle />
                <sb-first-error [control]="form.controls.teamId"/>
            </div>
            
            <div class="form-group">
                @if(showLabels()) {
                    <label [for]="'teamPosition'">Team Position</label>
                }               
                @if(teamPositionOptions(); as positionOptions){
                    <sb-select
                        [id]="'teamPosition'"
                        [options]="positionOptions"
                        placeholder="Select new position"
                        formControlName="teamPosition"
                        [color]="color()"/>
                }@else {
                    <input id="teamPosition" 
                        sbInputStyle 
                        formControlName="teamPosition" 
                        type="number"
                        placeholder="new Position" 
                        [color]="color()"/>
                }
                <sb-first-error [control]="form.controls.teamPosition"/>
            </div>
        </div>
    </div>

    <!-- Security Settings Section -->
    <div class="form-section">
        <h3>Security Settings</h3>
        <div class="form-row">
            <div class="form-group">
                @if(showLabels()) {
                    <label [for]="'twoFactorProvider'">2FA Method</label>
                }                <sb-select
                    [id]="'twoFactorProvider'"
                    [options]="twoFactorProviderOptions()"
                    placeholder="Select 2FA method"
                    formControlName="twoFactorProvider"
                    color="primary">
                </sb-select>
                <sb-first-error [control]="form.controls.twoFactorProvider"/>
            </div>
            
            <div class="form-group checkbox-group">
                <sb-checkbox formControlName="twoFactorEnabled" color="primary">
                    Enable Two-Factor Authentication
                </sb-checkbox>
            </div>
        </div>
    </div>    

    
        @if(showAddressSection()) {
            <div class="collapsible-content">
                <div class="form-section">
                    <h3>Address (Optional)</h3>
                    <div class="form-row">
                        <div class="form-group full-width">
                            @if(showLabels()) {
                                <label [for]="'line1'">Address Line 1</label>
                            }
                            <input 
                                [id]="'line1'" 
                                type="text" 
                                formControlName="line1" 
                                placeholder="Address Line 1" 
                                sbInputStyle />
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            @if(showLabels()) {
                                <label [for]="'line2'">Address Line 2</label>
                            }
                            <input 
                                [id]="'line2'" 
                                type="text" 
                                formControlName="line2" 
                                placeholder="Address Line 2" 
                                sbInputStyle />
                        </div>
                        
                        <div class="form-group">
                            @if(showLabels()) {
                                <label [for]="'line3'">Address Line 3</label>
                            }
                            <input 
                                [id]="'line3'" 
                                type="text" 
                                formControlName="line3" 
                                placeholder="Address Line 3" 
                                sbInputStyle />
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            @if(showLabels()) {
                                <label [for]="'line4'">Address Line 4</label>
                            }
                            <input 
                                [id]="'line4'" 
                                type="text" 
                                formControlName="line4" 
                                placeholder="Address Line 4" 
                                sbInputStyle />
                        </div>
                        
                        <div class="form-group">
                            @if(showLabels()) {
                                <label [for]="'line5'">Address Line 5</label>
                            }
                            <input 
                                [id]="'line5'" 
                                type="text" 
                                formControlName="line5" 
                                placeholder="Address Line 5" 
                                sbInputStyle />
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            @if(showLabels()) {
                                <label [for]="'areaCode'">Area Code</label>
                            }
                            <input 
                                [id]="'areaCode'" 
                                type="text" 
                                formControlName="areaCode" 
                                placeholder="Area Code" 
                                sbInputStyle />
                        </div>
                        
                        <div class="form-group">
                            @if(showLabels()) {
                                <label [for]="'appUserId'">App User ID</label>
                            }
                            <input 
                                [id]="'appUserId'" 
                                type="text" 
                                formControlName="appUserId" 
                                placeholder="App User ID" 
                                sbInputStyle />
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group full-width">
                            @if(showLabels()) {
                                <label [for]="'notes'">Notes</label>
                            }
                            <input 
                                [id]="'notes'" 
                                type="text" 
                                formControlName="notes" 
                                placeholder="Additional notes" 
                                sbInputStyle />
                        </div>
                    </div>
                </div>
            </div>
        }

    @if (_isUpdateForm()) {
        <sb-button (click)="update()" [disabled]="form.invalid" color="primary">
            Save Changes
        </sb-button>
    }@else {
        <sb-button (click)="add()" [disabled]="form.invalid" color="primary">
            Create User
        </sb-button>
    }

</form>
